<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Лист Персонажа</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Unicase:wght@700&display=swap" rel="stylesheet" />
  <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" referrerpolicy="no-referrer" rel="stylesheet" />
  <link href="style.css" rel="stylesheet" />
</head>
<body>
  <!-- Блок очікування -->
  <div id="waitingBlock" class="waiting-block">
    <i class="fas fa-hourglass-half waiting-icon"></i>
    <h2>Зачекайте, поки ГМ не видасть вам персонажа</h2>
  </div>

  <!-- Основний контент -->
  <div id="mainContent" class="main-container" style="display: none;">
    <!-- Ліва панель -->
    <div class="left-panel">
      <!-- Керування персонажами -->
      <div class="character-controls">
        <div class="character-select-group">
          <i class="fa-solid fa-user-shield character-icon"></i>
          <select id="characterSelect"></select>
          <button id="addCharacterButton" title="Додати персонажа">
            <i class="fas fa-plus"></i>
          </button>
          <button id="deleteCharacterButton" title="Видалити персонажа">
            <i class="fas fa-trash-alt"></i>
          </button>
        </div>
        <div class="player-name-block">
          <div class="name-input-group">
            <i class="fas fa-user" title="Ім'я гравця"></i>
            <select id="playerNameSelect"></select>
          </div>
        </div>
      </div>

      <div class="quick-actions-row">
        <div class="saves-and-advantages-block">
          <div class="death-saves">
            <div class="death-saves-group">
              <div class="death-saves-label">Успіхи</div>
              <div class="checkbox-group">
                <input id="deathSavesSuccess1" type="checkbox" />
                <input id="deathSavesSuccess2" type="checkbox" />
                <input id="deathSavesSuccess3" type="checkbox" />
              </div>
            </div>
            <div class="death-saves-group">
              <div class="death-saves-label">Провали</div>
              <div class="checkbox-group">
                <input id="deathSavesFailure1" type="checkbox" />
                <input id="deathSavesFailure2" type="checkbox" />
                <input id="deathSavesFailure3" type="checkbox" />
              </div>
            </div>
          </div>
          <div class="inspiration-advantage-block">
            <label class="advantage-label">Перевага <input id="advantageCheckbox" type="checkbox" /></label>
            <label class="disadvantage-label">Похибка <input id="disadvantageCheckbox" type="checkbox" /></label>
          </div>
          <div class="inspiration-block">
            <label class="inspiration-label"><span class="inspiration-crown" aria-label="Натхнення"><i class="fas fa-dice-d20"></i></span> <input id="inspirationCheckbox" type="checkbox" /></label>
          </div>
          <div class="help-block">
            <i class="fas fa-info-circle" title="Довідка"></i>
          </div>
        </div>
      </div>

      <div id="abilityScoresBlock">
        <div class="ability-scores">
          <div class="ability-score-item">
            <div class="ability-score-left">
              <div class="ability-score-label-row">
                <label>Сила</label>
              </div>
              <div class="ability-score-input-row">
                <div class="stat-input-wrapper">
                  <button class="stat-btn minus">−</button>
                  <input id="strengthScore" type="number" placeholder="10" min="0" max="99" step="1" />
                  <button class="stat-btn plus">+</button>
                </div>
                <button class="stat-edit-btn" title="Редагувати"><i class="fas fa-pen"></i></button>
              </div>
            </div>
            <div class="ability-score-mod-col">
              <div class="modifier-box" id="strengthModifier">+0</div>
            </div>
          </div>
          <div class="ability-score-item">
            <div class="ability-score-left">
              <div class="ability-score-label-row">
                <label>Спритність</label>
              </div>
              <div class="ability-score-input-row">
                <div class="stat-input-wrapper">
                  <button class="stat-btn minus">−</button>
                  <input id="dexterityScore" type="number" placeholder="10" min="0" max="99" step="1" />
                  <button class="stat-btn plus">+</button>
                </div>
                <button class="stat-edit-btn" title="Редагувати"><i class="fas fa-pen"></i></button>
              </div>
            </div>
            <div class="ability-score-mod-col">
              <div class="modifier-box" id="dexterityModifier">+0</div>
            </div>
          </div>
          <div class="ability-score-item">
            <div class="ability-score-left">
              <div class="ability-score-label-row">
                <label>Статура</label>
              </div>
              <div class="ability-score-input-row">
                <div class="stat-input-wrapper">
                  <button class="stat-btn minus">−</button>
                  <input id="constitutionScore" type="number" placeholder="10" min="0" max="99" step="1" />
                  <button class="stat-btn plus">+</button>
                </div>
                <button class="stat-edit-btn" title="Редагувати"><i class="fas fa-pen"></i></button>
              </div>
            </div>
            <div class="ability-score-mod-col">
              <div class="modifier-box" id="constitutionModifier">+0</div>
            </div>
          </div>
          <div class="ability-score-item">
            <div class="ability-score-left">
              <div class="ability-score-label-row">
                <label>Інтелект</label>
              </div>
              <div class="ability-score-input-row">
                <div class="stat-input-wrapper">
                  <button class="stat-btn minus">−</button>
                  <input id="intelligenceScore" type="number" placeholder="10" min="0" max="99" step="1" />
                  <button class="stat-btn plus">+</button>
                </div>
                <button class="stat-edit-btn" title="Редагувати"><i class="fas fa-pen"></i></button>
              </div>
            </div>
            <div class="ability-score-mod-col">
              <div class="modifier-box" id="intelligenceModifier">+0</div>
            </div>
          </div>
          <div class="ability-score-item">
            <div class="ability-score-left">
              <div class="ability-score-label-row">
                <label>Мудрість</label>
              </div>
              <div class="ability-score-input-row">
                <div class="stat-input-wrapper">
                  <button class="stat-btn minus">−</button>
                  <input id="wisdomScore" type="number" placeholder="10" min="0" max="99" step="1" />
                  <button class="stat-btn plus">+</button>
                </div>
                <button class="stat-edit-btn" title="Редагувати"><i class="fas fa-pen"></i></button>
              </div>
            </div>
            <div class="ability-score-mod-col">
              <div class="modifier-box" id="wisdomModifier">+0</div>
            </div>
          </div>
          <div class="ability-score-item">
            <div class="ability-score-left">
              <div class="ability-score-label-row">
                <label>Харизма</label>
              </div>
              <div class="ability-score-input-row">
                <div class="stat-input-wrapper">
                  <button class="stat-btn minus">−</button>
                  <input id="charismaScore" type="number" placeholder="10" min="0" max="99" step="1" />
                  <button class="stat-btn plus">+</button>
                </div>
                <button class="stat-edit-btn" title="Редагувати"><i class="fas fa-pen"></i></button>
              </div>
            </div>
            <div class="ability-score-mod-col">
              <div class="modifier-box" id="charismaModifier">+0</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Лист персонажа -->
      <div class="character-sheet" id="characterSheetContainer">
        <div class="sheet-columns">
          <div class="sheet-col-left">
            <div class="weapon-block">
              <div class="weapon-label-row">
                <div class="weapon-label-controls">
                  <span class="weapon-label">Атаки</span>
                  <div class="weapon-edit-group" style="display: flex; background: transparent; padding: 0; margin: 0;">
                    <button class="weapon-add-row-btn" id="weaponAddRowBtn" title="Додати рядок" style="display:none;"><i class="fas fa-plus"></i></button>
                    <button class="weapon-accept-btn" id="weaponAcceptBtn" title="Підтвердити" style="display:none;"><i class="fas fa-check-circle"></i></button>
                    <button class="weapon-cancel-btn" id="weaponCancelBtn" title="Відхилити" style="display:none;"><i class="fas fa-times-circle"></i></button>
                  </div>
                  <button class="weapon-edit-btn" id="weaponEditBtn" title="Редагувати"><i class="fas fa-pen"></i></button>
                </div>
              </div>
              <table class="weapon-table">
                <thead>
                  <tr>
                    <th>Назва</th>
                    <th class="weapon-table-center"><i class="fas fa-dice" title="Бонус"></i></th>
                    <th class="weapon-table-center"><i class="fas fa-dice-d20" title="Шкода"></i></th>
                    <th style="width:32px;"></th>
                  </tr>
                </thead>
                <tbody id="weaponTableBody">
                  <!-- Динамічні рядки -->
                </tbody>
              </table>
            </div>
            <!-- Блок монет -->
            <div class="coins-block">
              <div class="coins-block-minimal">
                <i class="fas fa-coins" title="Монети" style="margin-right: 10px;"></i>
                <span class="coin-label">Сен</span>
                <input type="number" id="senCoins" placeholder="0" min="0" max="999999" step="1" />
                <span class="coin-label">Гін</span>
                <input type="number" id="ginCoins" placeholder="0" min="0" max="999999" step="1" />
                <span class="coin-label">Кін</span>
                <input type="number" id="kinCoins" placeholder="0" min="0" max="999999" step="1" />
              </div>
            </div>
            <!-- Новий блок інвентаря -->
            <div class="inventory-block" style="margin-bottom: 0 !important; padding-bottom: 0 !important;">
              <div class="weapon-label-row" style="margin-bottom: 0 !important; padding-bottom: 0 !important;">
                <div class="weapon-label-controls">
                  <span class="weapon-label">Інвентар</span>
                  <div class="max-weight-wrapper" style="margin: 0 !important; padding: 0 !important; margin-left: 0 !important; margin-right: 0 !important;">
                    <input id="currentWeight" placeholder="0" type="number" min="0" max="999" step="1" readonly />
                  </div>
                  /
                  <div class="max-weight-wrapper" style="margin: 0 !important; padding: 0 !important; margin-left: 0 !important; margin-right: 0 !important;">
                    <input id="maxWeight" placeholder="50" type="number" min="0" max="999" step="1" readonly />
                  </div>
                  <div class="weapon-edit-group" style="display: flex; background: transparent; padding: 0; margin: 0;">
                    <button class="weapon-add-row-btn" id="inventoryAddRowBtn" title="Додати рядок" style="display:none;"><i class="fas fa-plus"></i></button>
                    <button class="weapon-accept-btn" id="inventoryAcceptBtn" title="Підтвердити" style="display:none;"><i class="fas fa-check-circle"></i></button>
                    <button class="weapon-cancel-btn" id="inventoryCancelBtn" title="Відхилити" style="display:none;"><i class="fas fa-times-circle"></i></button>
                  </div>
                  <button class="weapon-edit-btn" id="inventoryEditBtn" title="Редагувати"><i class="fas fa-pen"></i></button>
                </div>
              </div>
              <table class="weapon-table">
                <thead>
                  <tr>
                    <th>Назва</th>
                    <th class="weapon-table-center"><i class="fas fa-box" title="Кількість"></i></th>
                    <th class="weapon-table-center"><i class="fas fa-weight-hanging" title="Вага"></i></th>
                    <th style="width:32px;"></th>
                  </tr>
                </thead>
                <tbody id="inventoryTableBody">
                  <!-- Динамічні рядки -->
                </tbody>
              </table>
            </div>
            
            <!-- Блок спорядження -->
            <div class="equipment-block equipment-block--last" style="margin-bottom: 0 !important; padding-bottom: 0 !important;">
              <div class="weapon-label-row" style="margin-bottom: 0 !important; padding-bottom: 0 !important;">
                <div class="weapon-label-controls">
                  <span class="weapon-label">Спорядження</span>
                  <div class="weapon-edit-group" style="display: flex; background: transparent; padding: 0; margin: 0;">
                    <button class="weapon-add-row-btn" id="equipmentAddRowBtn" title="Додати рядок" style="display:none;"><i class="fas fa-plus"></i></button>
                    <button class="weapon-accept-btn" id="equipmentAcceptBtn" title="Підтвердити" style="display:none;"><i class="fas fa-check-circle"></i></button>
                    <button class="weapon-cancel-btn" id="equipmentCancelBtn" title="Відхилити" style="display:none;"><i class="fas fa-times-circle"></i></button>
                  </div>
                  <button class="weapon-edit-btn" id="equipmentEditBtn" title="Редагувати"><i class="fas fa-pen"></i></button>
                </div>
              </div>
              <table class="weapon-table">
                <thead>
                  <tr>
                    <th>Назва</th>
                    <th class="weapon-table-center"><i class="fas fa-shield-alt" title="Броня"></i></th>
                    <th class="weapon-table-center"><i class="fas fa-weight-hanging" title="Вага"></i></th>
                    <th style="width:32px;"></th>
                  </tr>
                </thead>
                <tbody id="equipmentTableBody">
                  <!-- Динамічні рядки -->
                </tbody>
              </table>
            </div>
            <div class="sheet-bottom-spacer"></div>
          </div>
          <div class="sheet-col-right">
            <div class="skill-block">
              <div class="skill-label-row">
                <div class="skill-label-controls">
                  <span class="skill-label">Навички</span>
                  <div class="skill-edit-group" style="display: flex; background: transparent; padding: 0; margin: 0;">
                    <button class="skill-add-row-btn" id="skillAddRowBtn" title="Додати рядок" style="display:none;"><i class="fas fa-plus"></i></button>
                    <button class="skill-accept-btn" id="skillAcceptBtn" title="Підтвердити" style="display:none;"><i class="fas fa-check-circle"></i></button>
                    <button class="skill-cancel-btn" id="skillCancelBtn" title="Відхилити" style="display:none;"><i class="fas fa-times-circle"></i></button>
                  </div>
                  <button class="skill-edit-btn" id="skillEditBtn" title="Редагувати"><i class="fas fa-pen"></i></button>
                </div>
              </div>
              <table class="skill-table">
                <tbody id="skillTableBody">
                  <!-- Динамічні рядки: кожен складається з поля назви (label+input) над полем опису (textarea), справа кнопка видалення -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Права панель -->
    <div class="right-panel">
      <div class="photo-block" id="photoBlock">
        <input id="characterName" placeholder="Ім'я персонажа" type="text" />
        
        <div class="photo-container">
          <div id="photoControls">
            <button id="replacePhotoButton" title="Завантажити фотографію">
              <i class="fas fa-upload"></i>
            </button>
            <button id="deletePhotoButton" title="Видалити фотографію">
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
          <img alt="Натисніть для завантаження фотографії" 
               id="characterPhotoImg" 
               src="/no-image-placeholder.svg"
               title="Натисніть для завантаження фотографії" />
        </div>

        <div class="quick-stats-block">
          <div class="quick-stat-item">
            <i class="fas fa-shield-alt" title="Клас Броні"></i>
            <div class="stat-input-wrapper">
              <button class="stat-btn minus">−</button>
              <input id="armorClass" placeholder="16" type="number" min="0" max="99" step="1" readonly />
              <button class="stat-btn plus">+</button>
            </div>
          </div>
          <div class="quick-stat-item">
            <i class="fas fa-running" title="Швидкість"></i>
            <div class="stat-input-wrapper">
              <button class="stat-btn minus">−</button>
              <input id="speed" placeholder="30" type="number" min="0" max="99" step="1" readonly />
              <button class="stat-btn plus">+</button>
            </div>
          </div>
          <div class="quick-stat-item">
            <i class="fas fa-plus" title="Лікування"></i>
            <div class="stat-input-wrapper">
              <button class="stat-btn minus">−</button>
              <input id="health" placeholder="0" type="number" min="0" max="99" step="1" />
              <button class="stat-btn plus">+</button>
            </div>
          </div>
          <div class="quick-stat-item">
            <i class="fas fa-spa" title="Ініціатива"></i>
            <div class="stat-input-wrapper">
              <button class="stat-btn minus">−</button>
              <input id="initiative" placeholder="0" type="number" min="0" max="99" step="1" />
              <button class="stat-btn plus">+</button>
            </div>
          </div>
          <div class="quick-stats-bottom-row">
            <div class="quick-stat-item">
              <i class="fas fa-heart" title="ХП"></i>
              <div class="stat-input-wrapper">
                <button class="stat-btn minus">−</button>
                <input id="healthPoints" placeholder="0" type="number" min="0" max="99" step="1" />
                <button class="stat-btn plus">+</button>
              </div>
            </div>
            <div class="quick-stat-item">
              <div class="stat-input-wrapper">
                <input id="maxHealthPoints" placeholder="12" type="number" min="0" max="99" step="1" readonly />
              </div>
            </div>
          </div>
        </div>

        <input accept="image/*" id="photoFileInput" style="display: none;" type="file" />
      </div>
    </div>
  </div>

  <div id="noCharacterMessage" style="display: none; text-align: center; margin-top: 20px;">
    У вас ще немає персонажів.
  </div>

  <!-- Модальне вікно з інформацією -->
  <div id="characterInfoModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Інформація про персонажа</h2>
        <span class="close-modal">&times;</span>
      </div>
      <div class="modal-body">
        <div class="modal-row-flex">
          <div class="skill-block modal-col-third">
            <div class="skill-label"><span class="modal-label-title">Клас</span>
              <button class="modal-edit-btn" id="editModalClass" title="Редагувати"><i class="fas fa-pen"></i></button>
              <button class="modal-accept-btn" id="acceptModalClass" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
              <button class="modal-cancel-btn" id="cancelModalClass" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
            </div>
            <textarea class="skill-desc-textarea" readonly id="modalCharacterClass"></textarea>
          </div>
          <div class="skill-block modal-col-third">
            <div class="skill-label"><span class="modal-label-title">Раса</span>
              <button class="modal-edit-btn" id="editModalRace" title="Редагувати"><i class="fas fa-pen"></i></button>
              <button class="modal-accept-btn" id="acceptModalRace" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
              <button class="modal-cancel-btn" id="cancelModalRace" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
            </div>
            <textarea class="skill-desc-textarea" readonly id="modalCharacterRace"></textarea>
          </div>
          <div class="skill-block modal-col-third">
            <div class="skill-label"><span class="modal-label-title">Світогляд</span>
              <button class="modal-edit-btn" id="editModalAlignment" title="Редагувати"><i class="fas fa-pen"></i></button>
              <button class="modal-accept-btn" id="acceptModalAlignment" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
              <button class="modal-cancel-btn" id="cancelModalAlignment" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
            </div>
            <textarea class="skill-desc-textarea" readonly id="modalAlignment"></textarea>
          </div>
        </div>
        <div class="skill-block">
          <div class="skill-label"><span class="modal-label-title">Зовнішність</span>
            <button class="modal-edit-btn" id="editModalAppearance" title="Редагувати"><i class="fas fa-pen"></i></button>
            <button class="modal-accept-btn" id="acceptModalAppearance" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
            <button class="modal-cancel-btn" id="cancelModalAppearance" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
          </div>
          <textarea class="skill-desc-textarea" readonly id="modalAppearance"></textarea>
        </div>
        <div class="skill-block">
          <div class="skill-label"><span class="modal-label-title">Риси характеру</span>
            <button class="modal-edit-btn" id="editModalPersonalityTraits" title="Редагувати"><i class="fas fa-pen"></i></button>
            <button class="modal-accept-btn" id="acceptModalPersonalityTraits" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
            <button class="modal-cancel-btn" id="cancelModalPersonalityTraits" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
          </div>
          <textarea class="skill-desc-textarea" readonly id="modalPersonalityTraits"></textarea>
        </div>
        <div class="skill-block">
          <div class="skill-label"><span class="modal-label-title">Особливості поведінки</span>
            <button class="modal-edit-btn" id="editModalFeatures" title="Редагувати"><i class="fas fa-pen"></i></button>
            <button class="modal-accept-btn" id="acceptModalFeatures" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
            <button class="modal-cancel-btn" id="cancelModalFeatures" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
          </div>
          <textarea class="skill-desc-textarea" readonly id="modalFeatures"></textarea>
        </div>
        <div class="skill-block">
          <div class="skill-label"><span class="modal-label-title">Передісторія</span>
            <button class="modal-edit-btn" id="editModalBackground" title="Редагувати"><i class="fas fa-pen"></i></button>
            <button class="modal-accept-btn" id="acceptModalBackground" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
            <button class="modal-cancel-btn" id="cancelModalBackground" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
          </div>
          <textarea class="skill-desc-textarea" readonly id="modalBackground"></textarea>
        </div>
        <div class="skill-block">
          <div class="skill-label"><span class="modal-label-title">Зв'язки</span>
            <button class="modal-edit-btn" id="editModalBonds" title="Редагувати"><i class="fas fa-pen"></i></button>
            <button class="modal-accept-btn" id="acceptModalBonds" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
            <button class="modal-cancel-btn" id="cancelModalBonds" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
          </div>
          <textarea class="skill-desc-textarea" readonly id="modalBonds"></textarea>
        </div>
        <div class="skill-block">
          <div class="skill-label"><span class="modal-label-title">Мови</span>
            <button class="modal-edit-btn" id="editModalLanguages" title="Редагувати"><i class="fas fa-pen"></i></button>
            <button class="modal-accept-btn" id="acceptModalLanguages" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
            <button class="modal-cancel-btn" id="cancelModalLanguages" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
          </div>
          <textarea class="skill-desc-textarea" readonly id="modalLanguages"></textarea>
        </div>
        <div class="skill-block">
          <div class="skill-label"><span class="modal-label-title">Примітки</span>
            <button class="modal-edit-btn" id="editModalNotes" title="Редагувати"><i class="fas fa-pen"></i></button>
            <button class="modal-accept-btn" id="acceptModalNotes" title="Підтвердити" style="display:none;"><i class="fas fa-check"></i></button>
            <button class="modal-cancel-btn" id="cancelModalNotes" title="Відхилити" style="display:none;"><i class="fas fa-times"></i></button>
          </div>
          <textarea class="skill-desc-textarea" readonly id="modalNotes"></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- Модальне вікно для навичок більше не потрібне -->
  
  <script src="main.js" type="module"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const helpIcon = document.querySelector('.help-block i');
      const mainContent = document.getElementById('mainContent');
      const closeModal = document.querySelector('.close-modal');
      const modal = document.getElementById('characterInfoModal');
      function closeHelp() {
        if (mainContent) mainContent.classList.remove('darken-bg');
      }
      if (helpIcon && mainContent) {
        helpIcon.addEventListener('click', function() {
          mainContent.classList.add('darken-bg');
        });
      }
      if (closeModal) {
        closeModal.addEventListener('click', closeHelp);
      }
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeHelp();
      });
    });
  </script>
</body>
</html>